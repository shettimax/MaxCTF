@php
    $candidateForm = App\Models\CandidateForm::find($candform->id);
   $formSetting = $candidateForm->formsetting;
   $session = $formSetting->session;
@endphp
<html>
<head>
    {{--<title>Notification Admission {{ $candform->id .$candform->formsetting()->session }}:Ahmadu Bello University:</title>--}}
    <title>Notification Admission {{ $session }}:Ahmadu Bello University:</title>
</head>
<body>
<div class="main-section">

    <div class="col-md-12">
        @php
            $candidateForm = App\Models\CandidateForm::find($candform->id);
    $formSetting = $candidateForm->formSetting; // Assuming "formsetting" is a BelongsTo relationship.
    $session = $formSetting->session; // Access the "session" property on the related FormSetting model.

                $dt = Carbon\Carbon::parse($candform->updated_at);
                $programme = App\Models\Programme::find($candform->programme_admitted_id);
             $candform->formSetting->session;
        @endphp
        <div id="notifications">

            <div class="panel-collapse collapse in">
                <div class="panel-body">
                    <div class="cs-blog cs-blog-medium col-md-9">
                        <div style="width:849px;height:1202px;background-color: #fff;background-image:  url('{{ asset('watermark_bg.png') }}') ;background-size: cover;padding:2px;overflow-y: hidden;">

                            <div class='row'>
                                <div class='col-md-4'>

                                </div>
                                <div class='col-md-4'></div>
                                <div class='col-md-4'></div>
                                <div class='col-md-4'></div>
                            </div>
                            <div class='row' style="display: flex; align-items: center; justify-content: space-between;">
                                <div class='col-md-4' style="display: flex; align-items: center;">
                                    <img src="{{ asset('images/logo96.png') }}" style="height: 96px;">
                                </div>
                                <div class='col-md-4'></div>
                                <div class='col-md-4' style="display: flex; justify-content: flex-end; align-items: center;">
                                    <img src="{{ route("candidate.profile.image",[time()]) }}" height="96" style="border: 2px solid #00B22D; border-radius: 5px;">
                                </div>
                            </div>
                            <div class='row'>
                                <div class='col-md-8'></div>
                                <div class='col-md-4' style="border:none;">
                                    <div style="font-weight:900;padding:10px 8px 0 0;text-align:right;display: inline-block;height: 40px;float: right;width: 320px;background-image: url({{ asset('app_label.png') }});background-size: 100%;background-repeat: no-repeat;">
                                        <strong>App. No:</strong>{{ $candform->id}}
                                    </div>
                                </div>
                            </div>
                            <div class='row'>
                                <div class='col-md-4' colspan="4" style="border-bottom: 2px #0fa917 solid;">
                                    <div class="text-lg-center">
                                        <h3 class="app-name"
                                            style="margin: 20px 0;font-weight: bolder;color: #00B22D;font-size: 24px;border-bottom: 2px solid #00B22D;text-align:center;">
                                            @php
                                                $thisUser = Auth::user();
                                                $biodata = $thisUser->biodata();
                                            @endphp
                                            {{ $biodata->surname .", ". $biodata->firstname . " ". $biodata->othernames }}
                                        </h3>
                                        <h3>Jamb Registration Number:{{$candidate->username}}</h3>
                                    </div>
                                </div>
                            </div>
                            <div class='row'>
                                <div class='col-md-4'>
                                    <div style="text-align:center;">
                                        <h2 style="color: #D96D00 !important;text-align:center;">NOTIFICATION OF
                                            ADMISSION</h2>
                                    </div>
                                </div>
                            </div>
                            <div class='row'>
                                <div class='col-md-4' colspan="4">
                                    <div class="noa-body">
                                        <p>
                                            I am pleased to notify you that you have been offered
                                            provisional admission to study
                                            <strong style="font-weight: 900;text-decoration: underline;">{{$programme->name}}</strong>
                                            in the
                                            <strong style="font-weight: 900;text-decoration: underline;">
                                            <?php
                                                if($programme->department()->faculty()->type !='Institute'){
                                                    echo $programme->department()->faculty()->type .' of';
                                                }
                                            ?>
                                            </strong>

                                            <strong style="font-weight: 900;text-decoration: underline;">{{$programme->department()->faculty()->name}}</strong>
                                            during the <strong
                                                style="font-weight: 900;text-decoration: underline;">{{$candform->formsetting->session}}
                                                /{{$candform->formsetting->session+1}}</strong> academic
                                            session. You are to visit any of the JAMB CBT Centre to accept the offer, and print your JAMB Admission letter as part of the document required for registration.
                                        </p>
                                        <p>
                                            <strong>Please note the following</strong>
                                        </p>
                                        <p class="indent">

                                            i. You are to present yourself for screening <?php if($programme->department()->faculty()->type =='Faculty'){ echo 'from 1<sup>st</sup> December, 2025 to 12<sup>th</sup> December, 2025'; }?> at
                                            <?php if($programme->department()->faculty()->type =='Faculty'){ echo 'Mamman Kontagora Square Main Campus.'; }

                                            else{
                                                echo "<strong
                                                style='font-weight: 900;text-decoration: underline;'>{{$programme->department()->faculty()->name}}</strong> Board
                                            Room by  <strong
                                                style='font-weight: 900;text-decoration: underline;'>{{$programme->department()->name}}</strong>
                                            Departmental
                                             Screening
                                            Officers.";
                                            }?>
                                            The exercise is to ensure that you meet the
                                            University, Department and
                                            Programme entry requirements. Registration last for two weeks excluding Public Holidays.
                                        </p>
                                        <p class="indent">
                                            ii. The documents required for registration are:.
                                        <ol type="a">
                                            <li>JAMB Admission Letter</li>
                                            <li>Post UTME Results</li>
                                            <li>O’Level Results</li>
                                            <li>A’Level Results (DE Student)</li>
                                            <li>Indigene Certificate</li>
                                            <li>Birth Certificate / Declaration of Age</li>
                                        </ol>
                                        </p>

                                        <p class="indent">
                                            iii. Name abbreviation, initials and name inconsistency will
                                            not be accepted in the registration exercise.
                                        </p>

                                    </div>
                                </div>
                                <div class='col-md-4' colspan="2">
                                    <table>
                                        <tr>
                                            <td colspan="1">
                                                <h1 class="congr">Congratulations</h1>
                                            </td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td colspan="1">
                                                @php 
                                                    $config = $programme->getConfig(\App\Models\Configuration::NOTIFICATION_OF_ADMISSION);
                                                    // Debug information (remove in production)
                                                    $debug_info = [
                                                        'programme_id' => $programme->id,
                                                        'programme_name' => $programme->name,
                                                        'config_exists' => $config ? 'Yes' : 'No',
                                                        'config_signature' => $config ? $config->signature : 'N/A',
                                                        'config_config' => $config ? $config->config : 'N/A',
                                                        'config_position' => $config ? $config->position : 'N/A'
                                                    ];
                                                @endphp
                                                
                                                {{-- Debug info (remove in production) --}}
                                                @if(config('app.debug'))
                                                <div style="background: #f0f0f0; padding: 10px; margin: 10px 0; font-size: 12px; border: 1px solid #ccc;">
                                                    <strong>Debug Info:</strong><br>
                                                    Programme ID: {{ $debug_info['programme_id'] }}<br>
                                                    Programme Name: {{ $debug_info['programme_name'] }}<br>
                                                    Config Exists: {{ $debug_info['config_exists'] }}<br>
                                                    Signature: {{ $debug_info['config_signature'] }}<br>
                                                    Config: {{ $debug_info['config_config'] }}<br>
                                                    Position: {{ $debug_info['config_position'] }}
                                                </div>
                                                @endif
                                                
                                                @if($config && $config->signature)
                                                <img src="{{ asset($config->signature) }}" alt="" width="120"
                                                     class="indent">
                                                    <h3>{{ $config->config }}</h3>
                                                    <h3 class="congr">{{ ucwords($config->position) }}</h3>
                                                @else
                                                <img src="{{ asset('signatures/academic_secretary.png') }}" alt="" width="120"
                                                     class="indent">
                                                    <h3>Academic Secretary</h3>
                                                    <h3 class="congr">Academic Secretary</h3>
                                                @endif
                                                {{--<h3>{{ $secretary }}</h3>--}}
                                                <div class="date">
{{--                                                    {{ $dt->format("d/m/Y") }}--}}
                                                </div>
                                            </td>
                                            <td style="width: 200px;"></td>
                                            <td style="width: 200px;"></td>
                                            <td>
                                                <div style="color: #D96D00;">Verify Here</div>
{{--                                                <img src="{{ route('qr',[$candform->id .$candform->formsetting()->session]) }}"--}}
{{--                                                     alt="">--}}

                                                {{--@php--}}
                                                    {{--use Endroid\QrCode\ErrorCorrectionLevel;--}}
                                                    {{--$qrCode = new Endroid\QrCode\QrCode($candform->id);--}}
                                                    {{--$qrCode->setEncoding('UTF-8');--}}
                                                    {{--$qrCode->setErrorCorrectionLevel(ErrorCorrectionLevel::HIGH());--}}
                                                    {{--$qrCode->setForegroundColor(['r' => 0, 'g' => 136, 'b' => 34, 'a' => 0]);--}}
                                                    {{--$qrCode->setLabel("Scan Here", 14);--}}
                                                    {{--$qrCode->setSize(128);--}}
                                                    {{--$qrCode->setLogoPath('admissions/abu_logo.png');--}}
                                                    {{--$qrCode->setLogoSize(64, 64);--}}
                                                    {{--$qrCode->setValidateResult(false);--}}
                                                {{--@endphp--}}

                                                {{--<img src="{{ $qrCode->writeDataUri() }}" alt="">--}}
                                                {!! QrCode::size(160)->generate($candform->id); !!}
                                            </td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                    </table>

                                </div>
                                <div class="row">
                                    @foreach ($candidateForms as $candform)
                                        @if (in_array($candform->candidate_form_type_id, [13, 14, 15, 16]))
                                            @if ($candform->admission_status == 'admitted')
                                                @if ($candform->acceptance_date == null)
                                                    <div class="cs-thumb-post" style="text-align: center;">
                                                    You are expected to accept this offer before the registration exercise is completed.
                                                    <a href="{{ route('admission.accept', [encrypt($candform->id)]) }}" class="btn btn-success btn-sm">Accept</a>
                                                    <br>
{{--                                                    <a href="{{ route('feedback.admission.index', ['id' => encrypt($candform->id)]) }}" class="btn btn-info btn-sm">--}}
{{--                                                        <i class="icon icon-download4"></i>--}}
{{--                                                        Download Notification{{$candform->id}}--}}
{{--                                                    </a>--}}
                                                @elseif ($candform->screening_status == 'Qualified')
                                                    <div class="cs-thumb-post" style="text-align: center;">
                                                        @if ($candform->admission_status == 'admitted' && $candform->acceptance_date)

                                                        @endif
                                                        @if ($candform->admission_status == 'admitted' && $candform->screening_status == 'Qualified' && $candform->acceptance_date)
{{--                                                            @if (!$candform->paidSundry())--}}
{{--                                                                    <h3 class="text-center">Pay <strong>Acceptance</strong> and <strong>Other Charges</strong></h3>--}}
{{--                                                                <a href="{{ route('admission.pay', ['id' => encrypt($candform->id)]) }}" class="btn btn-info btn-sm">--}}
{{--                                                                    <i class="icon icon-credit-card"></i>--}}
{{--                                                                    Pay Securely--}}
{{--                                                                </a>--}}
{{--                                                            @endif--}}
                                                            @if ($candform->paidSundry())
                                                                <a class="btn btn-info btn-sm" href="{{ route('admission.pay', ['id' => encrypt($candform->id)]) }}">
                                                                    <i class="icon icon-print"></i>
                                                                    Print Receipt
                                                                </a>
                                                            @endif
                                                        @endif
                                                    </div>
                                                @endif
                                            @endif
                                        @endif
                                    @endforeach

                                </div>
                                <div class="col-md-5"></div>
                                <div class="col-md-3">

                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>

        </div>

    </div>

</div>
</div>
</body>
<style>

    .guidelines li {
        margin-bottom: 10px;
    }

    .page-break {
        page-break-after: always;
    }



    h1.congr {
        color: #00B22D !important;
    }

    h3.congr {
        color: #00B22D !important;
    }

    div.date {
        margin: 30px 0;
        color: #D96D00 !important;
        font-size: 14pt !important;
        text-decoration: underline;
        padding-left: 82px;
    }

    div.warning {
        display: inline-block;
        width: 100%;
        color: #D96D00 !important;
        font-size: 14pt !important;
        text-decoration: underline;
        padding-left: 40px;
        margin-bottom: -20px;
    }

    .indent {
        margin-left: 20px;
    }

    .noa-body p {
        padding: 5px 10px;
        font-size: 14pt !important;
        color: #00B22D !important;
    }

    .noa-table {
        height: 100%;
        border-bottom: 5px solid #00B22D;
    }

    .noa-body p strong {
        font-size: 14pt !important;
        color: #00B22D !important;
    }

    .noa-body ol li {
        font-size: 14pt !important;
        color: #00B22D !important;
    }

    .main-section {
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
    }

    .container {
        max-width: 900px;
        margin: 0 auto;
        padding: 20px;
    }

    @media print {
        body {
            margin: 0;
            padding: 0;
            font-size: 12pt;
        }

        .main-section {
            display: block !important;
            min-height: auto !important;
        }

        .container {
            max-width: 100% !important;
            margin: 0 !important;
            padding: 10px !important;
        }

        .row {
            page-break-inside: avoid;
        }

        .noa-body {
            page-break-inside: avoid;
        }

        @page {
            margin: 0.5in;
            size: A4;
        }
    }

    .noa-table h2 {
        color: #D96D00 !important;
        font-size: 28px !important;
    }

    .noa-table h3.app-name {
        margin: 5px 0;
        font-weight: bolder;
        color: #00B22D !important;
        font-size: 38px !important;
        border-bottom: 2px solid #00B22D;
    }

    .date-time {
        float: left;
        text-align: center;
        width: 60px;
        border-radius: 3px;

    }

    .date-time span {
        color: #fff;
        display: block;
        font-size: 11px;
        margin: 0;
        padding: 3px 0 4px;
        text-transform: uppercase;
        background-color: #062d66;
        border-radius: 3px 3px 0 0;
        width: 100%;
    }

    .date-time strong {
        font-size: 28px;
        color: #fff;
        font-weight: 700;
    }

    .date-time em {
        background: #062d66;
        color: #fff;
        display: inherit;
        padding: 3px;
        border-radius: 0 0 3px 3px;
        font-style: normal;
        letter-spacing: 1px;
        line-height: 22px;
        font-size: 16px;
    }

    .events-listing .date-time ~ section {
        padding: 0 0 0 92px;
    }

    .events-listing .text {
        display: inline-block;
        width: 82%;
    }

    .events-listing .text span {
        display: inline-block;
    }

    .events-listing article {
        border-bottom: 1px solid #ccc;
        display: table;
        margin: 0 0 30px;
        padding: 0 0 24px;
        width: 100%;
    }

    .events-listing .text span a {
        float: left;
        font-size: 12px;
        line-height: 20px;
        font-weight: 700;
        color: #fff;
        padding: 2px 10px;
        margin: 0 4px 12px 0;
        text-transform: uppercase;
        background-color: #3397c9;
    }

    .events-listing .text h2 {
        float: left;
        width: 100%;
        font-size: 24px;
        font-weight: 700;
        margin-bottom: 7px;
        line-height: 22px;
        text-transform: uppercase;
    }

    .events-listing .text h2 a {
        color: #333;
    }

    /*.events-listing .post-options {
        width: 100%;
        float: left;
        padding: 0 0 12px;
        margin: 0 0 9px 0;
        background:url(assets/images/spreater-img.png) repeat-x bottom;
    }*/
</style>


</html>
