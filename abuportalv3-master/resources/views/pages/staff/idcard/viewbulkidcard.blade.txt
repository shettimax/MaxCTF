<!doctype html>
<html>
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>ABU ID CARD</title>
    @include("commons.staff.head")
        <link href="{{asset('css/print.css')}}" rel="stylesheet" type="text/css">
        <link href="{{asset('css/SpryTabbedPanels.css')}}" rel="stylesheet" type="text/css">
    <!-- student id cards js -->
        <script src="{{asset('js/SpryTabbedPanels.js')}}" type="text/javascript"></script>
    <style>
        table tbody tr td {
            border:none;
            padding:0px;
            font-size: 11px;
        }
        .style1 {color: #008cce}
        .style6 {
            font-weight: bold;
            font-size: 14px;
            color: #000000;
        }
        .style8 {color: #008cce; font-size: 24px; }
        .style13 {font-size: 17px}
        .style14 {
            color: #008CCE;
            font-style: italic;
            font-weight: bold;
        }
        .style19 {
            color: #000000;
            font-weight: bold;
        }
        .style20 {color: #FFFFFF}
        .style21 {color: #000000}
        .style25 {color: #FFFFFF; font-weight: bold; }
        .style26 {
            font-size: 14px;
            font-weight: bold;
        }
        .style27 {font-size: 14px}
        .style29 {
            color: #0099CC;
            font-weight: bold;
        }

        .id-card-front {
            width:370px !important;
            min-height:234px !important;
            max-height:234px !important;
            overflow: hidden;
            border:10px solid #1eacae !important;
            border-radius: 20px 20px 20px 20px;
            -moz-border-radius: 20px 20px 20px 20px;
            -webkit-border-radius: 20px 20px 20px 20px;
           /* padding: 2px 5px;*/
            background-image: url({{asset('img/watermark.png')}}) !important;
            background-position: center;
            background-size: initial;
            background-repeat: repeat;
        }

        .id-card-back {
            width:370px !important;
            min-height:234px !important;
            max-height:234px !important;
            overflow: hidden;
            border:15px solid #1eacae;
            border-radius: 20px 20px 20px 20px;
            -moz-border-radius: 20px 20px 20px 20px;
            -webkit-border-radius: 20px 20px 20px 20px;
            /*padding: 2px 5px;*/
            {{--border-image: url({{asset("img/border.png")}}) 21% round !important;--}}
            background-position: center;
            background-size: initial;
            background-repeat: repeat;
        }

        .id-card-front-title, .id-card-front-body .id-card-front-data{
            border: none;
        }
        .id-card-front-title-text{
            font-size: 14px;
            font-weight: 800 !important;
            color: #008822 !important;
        }
        .id-card-front-title-text-2{
            font-size: 12px;
            font-weight: 800 !important;
            color: #ff0000 !important;
        }

        .id-card-text-header{
            font-size: 10px;
            font-weight: 800 !important;
            color: #1818a7 !important;
        }

        .id-card-text{
            font-size: 11px;
            font-weight: 700 !important;
        }

        table {
            border-collapse: initial !important;
            margin:0 auto;
        }

        .id-card-front-data{
            padding-left: 8px !important;
        }

        @media print {
            #printbtn {
                display: none;
            }

            * {
                padding: 0 !important;
                /*padding-left: 0 !important;
                padding-bottom: 0 !important;*/
                margin: 0 !important;
            }

            .id-card-front {
                page-break-after: always;
            }
            .id-card-back {
                page-break-after: always;
            }
        }

        .watermarked {
            position: relative;
        }

        .watermarked:after {
            content: "";
            display: block;
            width: 100%;
            height: 100%;
            position: absolute;
            top: 70px;
            left: 20px;
            background-image: url({{asset('img/big_watermark.png')}}) !important;
            /*background-size: 100px 100px;*/
            background-position: 20px 20px !important;
            background-repeat: no-repeat !important;
            opacity: 0.7;
            -ms-transform: rotate(-25deg); /* IE 9 */
            transform: rotate(-25deg);
        }


    </style>

</head>

<body>
<div class="container col-md-12 ml-2" style="padding-top: 1.5px !important;">
    @foreach($students as $student)
        @php
            $matric = str_replace("/", "_", strtoupper($student->matric_number));
            $imageUrl = "https://static.abu.edu.ng/uploads/student/photos/{$matric}.JPG";

//          Check if image exists
            $headers = @get_headers($imageUrl);
            $imageExists = $headers && strpos($headers[0], '200') !== false;
        @endphp
{{--   //     @if(file_exists(public_path() . '/studentpics/' . $matric . '.JPG'))--}}
        @if($imageExists)
{{--            <img src="https://static.abu.edu.ng/uploads/student/photos/{{ strtoupper($student->matric_number) }}.JPG" alt="Student Photo">--}}

            <div class="row id-card-front watermarked" style="margin: 10px auto 10px auto;" >
            <table class="id-card-front-title" cellpadding="0" cellspacing="0">
                <tbody>
                <tr>
                    <td rowspan="3" align="left" width="70"><img src="{{asset('img/abu_logo.png')}}" width="100%"></td>
                    <td align="center"><span class="id-card-front-title-text">AHMADU BELLO UNIVERSITY</span></td>
                </tr>
                <tr>
                    <td align="center"><span class="id-card-front-title-text">ZARIA-NIGERIA</span></td>
                </tr>
                <tr>
                    <td colspan="2" align="center" style="padding-top: 10px; padding-bottom: 10px !important;"><span class="id-card-front-title-text-2">STUDENT IDENTITY CARD</span></td>
                </tr>
                </tbody>
            </table>

            <table class="id-card-front-body" cellpadding="0" cellspacing="0">
                <tbody>
                <tr>
                    <td>
                        <table class="id-card-front-data" cellpadding="0" cellspacing="0" style="line-height: 18px !important;">
                            <tbody>
                            <tr>
                                <td class="id-card-text-header">REG NO.:</td>
                                <td class="id-card-text">{{$student->matric_number}}</td>
                            </tr>
                            <tr>
                                <td class="id-card-text-header">NAME:</td>
                                <td class="id-card-text">{{ htmlspecialchars(\App\Models\Student::iDCardName($student->id), ENT_QUOTES, 'UTF-8') }}</td>
                            </tr>
                            <tr>
                                <td class="id-card-text-header">COURSE:</td>
                                <td class="id-card-text">{{ htmlspecialchars(\App\Models\Programme::iDProgramme($student->programname), ENT_QUOTES, 'UTF-8') }}</td>
                            </tr>
                            <tr>
                                <td class="id-card-text-header">Expiry Date:</td>
                                <td class="id-card-text">{{$student->entry_session + $student->duration}}</td>
                            </tr>
                            <tr>
                                <td class="id-card-text-header">SEX/BLD GRP:</td>
                                <td class="id-card-text">
                                    {{strtoupper(substr($student->gender,0,1)) .'/'.strtoupper($student->blood_group)}}
                                    <span class="id-card-text-header">DOB</span> <span class="id-card-text">{{$student->dob}}</span>
                                </td>
                                {{--<td class="id-card-text-header">DOB:</td>
                                <td class="id-card-text" width="80%">{{$student->dob}}</td>--}}
                            </tr>
                            <tr>
                                <td class="id-card-text-header">STATE OF ORIGIN:</td>
                                <td class="id-card-text">{{ htmlspecialchars($student->statename, ENT_QUOTES, 'UTF-8') }}</td>
                            </tr>
                            <tr>
                                <td class="id-card-text-header" style="padding-top:5px !important;">HOLDER'S SIGN:</td>
                                <td class="id-card-text" style="padding-top:5px !important;"><img src="https://static.abu.edu.ng/uploads/student/signatures/{{str_replace('/', '_', strtoupper($student->matric_number))}}.JPG" style="width: 70px !important; height: 15px !important;"></td>
                            </tr>
                            </tbody>
                        </table>
                    </td>
                    <td rowspan="3" align="left" width="70" style="padding-right:5px !important; width: 110px !important; height: 35px !important;">
                        <img src="https://static.abu.edu.ng/uploads/student/photos/{{strtoupper($student->matric_number)}}.JPG" style="width:100% !important; height:140px !important; bottom:10px !important; margin-right: 5px !important; border:2px solid #1eacae; border-radius: 10px">
                    </td>
                </tr>

                </tbody>
            </table>

        </div>
        <div class="id-card-back" style="margin: 20px auto 5px auto">
            <div style="height:204px; border:2px solid #000000;">
            <table class="id-card-front-title" cellpadding="0" cellspacing="0" style="line-height: 16px !important;">
                <tbody>
                <tr>
                    <td rowspan="3" align="left" width="50"><img src="{{asset('img/abu_logo_black.png')}}" width="100%"></td>
                    <td align="left">1. This card must be the owner's possession at all time</td>
                </tr>
                <tr>
                    <td align="left">2. Loss must be reported to the Chief Security Office or nearest Police station</td>
                </tr>
                <tr>
                    <td align="left">3. Any alteration or erasure would render this card invalid.</td>
                </tr>

                </tbody>
            </table>

            <table class="id-card-front-body" cellpadding="0" cellspacing="0">
                <tbody>
                <tr>
                    <td>
                        <table class="id-card-front-data" cellpadding="0" cellspacing="0" style="padding-top:10px !important;">
                            <tbody>
                            <tr>
                                <td class="id-card-text">NEXT OF KIN:</td>
                                <td class="id-card-text">{{ htmlspecialchars($student->nok_name, ENT_QUOTES, 'UTF-8') }}</td>
                            </tr>
                            <tr>
                                <td class="id-card-text">ADDRESS:</td>
                                <td class="id-card-text" style="font-size: 8px;">{{ htmlspecialchars(ucwords($student->nok_address), ENT_QUOTES, 'UTF-8') }}</td>
                            </tr>
                            <tr>
                                <td class="id-card-text">PHONE No:</td>
                                <td class="id-card-text">{{$student->nok_gsm}}</td>
                            </tr>
                            <tr>
                                <td class="id-card-text" width="40%">HOLDER'S PHONE No:</td>
                                <td class="id-card-text">{{$student->gsm}}</td>
                            </tr>
                            </tbody>
                        </table>
                        <table style="padding-top: 10px !important;">
                            <tbody>
                            <tr>
                                <td align="center">
                                    Revalidation<br>
                                    @php
                                        $qrData = $student->matric_number.'-'.$student->fullname.'-'.$student->programname.'-'.$student->gsm.'-'.$student->home_address.'-'. $student->nok_name.'-'.$student->nok_gsm.'-'.$student->nok_address;
                                        // Remove or replace special characters that can't be encoded to ISO-8859-1
                                        $qrData = preg_replace('/[^\x00-\x7F]/', '', $qrData);
                                        $qrData = str_replace(['"', "'", '&', '<', '>'], ['', '', 'and', '', ''], $qrData);
                                    @endphp
                                    {!! QrCode::size(40)->generate($qrData); !!}
                                </td>
                                <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
                                <td>
                                    Ag. Chief Security Officer<br>
                                    <img src="{{asset('executivesignatures/chiefsecuritysign.jpg')}}" width="120" height="45"></td>
                            </tr>
                            </tbody>
                        </table>
                    </td>

                </tr>

                </tbody>
            </table>
            </div>
            {{--<div class="card mt-2 mb-2" style="width: 370px; height: 220px;">
                <div class="row no-gutters">
                    <div class="col-xs-4 justify-content-center">
                        <img class="mb-2 mt-2 ml-2 d-block" src="{{asset('images/logo96.png')}}"
                             width="80px;" height="80px;" alt="..." style="margin-bottom:.5rem;">
                        {!! QrCode::size(60)->generate($student->matric_number); !!}

                    </div>
                    <div class="col-xs-8">
                        <div class="card-body mt-4 ml-2">
                            --}}{{--<div class="mb-2 text-dark"
                                 style="font-size: 8px; font-weight: bolder;">
                                <p class="card-text" style="margin: unset">1. This is to
                                    certify that the person whose
                                    photograph and <br/> data appear overleaf is a
                                    student of Ahmadu Bello <br/>University,
                                    Zaria.</p>
                                <p class="card-text" style="margin: unset">2. This card
                                    must be in ownner's possesion at all
                                    times.</p>
                                <p class="card-text" style="margin: unset">3. Loss must
                                    be reported to the Chief Security
                                    Officer of the <br/> University or nearest Police
                                    Station.
                                <p class="card-text" style="margin: unset">4. Any
                                    alteration or erasure would render this
                                    card invalid.</p>
                                <p class="card-text">5. This card must be surrenderd to
                                    the University <br/>upon request.
                                </p>
                                <p class="card-text text-uppercase" style="margin: unset">Next of
                                    Kin:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{$student->nok_name}}</p>
                                <p class="card-text text-uppercase" style="margin: unset">Phone
                                    Number:{{$student->nok_gsm}}
                                </p>
                                <p class="card-text mt-1" style="margin: unset">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Chief
                                    Security Officer:<img
                                        src="{{asset('images/signature.png')}}" alt="..."
                                        width="60px;" height="20px;"></p>
                            </div>--}}{{--
                        </div>
                    </div>
                </div>
            </div>--}}
        </div>
        @endif
    @endforeach
    <div class="row" style="margin-left: 50%; margin-top: 15px;" id="printbtn">
        <a href="#" onclick="window.print();return false;" class="btn btn-info"><span>Print</span></a>
    </div>
</div>
</body>
</html>
