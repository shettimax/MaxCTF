<?php

use App\Http\Controllers\AccommodationController;
use App\Http\Controllers\BlockController;
use App\Http\Controllers\ConditionalMessageController;
use App\Http\Controllers\ErrorController;
use App\Http\Controllers\ExamCardController;
use App\Http\Controllers\FeesController;
use App\Http\Controllers\GradeBookController;
use App\Http\Controllers\MiscController;
use App\Http\Controllers\ResitController;
use App\Http\Controllers\Student\ABUMFBController;
use App\Http\Controllers\Student\CourseRegistrationController;
use App\Http\Controllers\Student\DashboardController;
use App\Http\Controllers\Student\EvaluationController;
use App\Http\Controllers\Student\LoginController;
use App\Http\Controllers\StudentBiodataController;
use App\Http\Controllers\StudentOlevelController;
use App\Http\Controllers\StudentAlevelController;
use App\Http\Controllers\StudentPhotoUploadController;
use App\Http\Controllers\StudentSignatureUploadController;
use App\Http\Controllers\TransactionController;
use App\Http\Controllers\UserController;
use App\Http\Controllers\Student\StudentDocumentsController;
use Illuminate\Support\Facades\Auth;
use Illuminate\Support\Facades\Route;

/*
|--------------------------------------------------------------------------
| Web Routes
|--------------------------------------------------------------------------
|
| Here is where you can register web routes for your application. These
| routes are loaded by the RouteServiceProvider within a group which
| contains the "web" middleware group. Now create something great!
|
*/

Route::get("/", function () {
    Auth::guard("student")->logout();
    Auth::guard("staff")->logout();
    Auth::guard("candidate")->logout();
//    $request->session()->invalidate();
    return redirect(route("index"));
})->name("root");

Route::get("/home", function () {
    return redirect(route("student.dashboard"));
})->name("home");

Route::get("/maintenace", function () {
    return view("pages.maintenance.index");
})->name("mmode");
Route::get("/my-matric/{appno}", [\App\Http\Controllers\Student\LoginController::class, "myMatric"])->name("student.matric");
Route::get("/dashboard/nin", [\App\Http\Controllers\Student\DashboardController::class, "ninUpdate"])->name("student.ninupdate");
Route::post("/dashboard/nin/save", [\App\Http\Controllers\Student\DashboardController::class, "ninUpdatePost"])->name("student.ninupdate.post");
Route::post("/login", [\App\Http\Controllers\Student\LoginController::class, "login"])->name("login");//->middleware("throttle:login");
Route::get("/logout", [\App\Http\Controllers\Student\LoginController::class, "logout"])->name("logout");
Route::get("/", [\App\Http\Controllers\Student\LoginController::class,"showLogin"])->name("index");

Route::get("notification/open/{id}", [ConditionalMessageController::class, "index"])->name("notification.index");
Route::post("notification/accepted/", [ConditionalMessageController::class, "accepted"])->name("notification.accepted");


Route::prefix("/")->middleware(['checknin'])->group(function () {



Route::prefix("/notification")->group(function () {
    Route::get("/dashboard", [DashboardController::class, "index"])->name("student.dashboard");
    Route::get("/admissionletter", [DashboardController::class, "printAdmissionLetter"])->name("student.admission.letter");
    Route::get("/admissionletter/pg", [DashboardController::class, "printAdmissionLetterPg"])->name("student.admission.pg.letter");
    Route::get("/diplomaadmissionletter", [DashboardController::class, "printDiplomaAdmissionLetter"])->name("diploma.student.admission.letter");
    Route::get("/ioeadmissionletter", [DashboardController::class, "printIoeAdmissionLetter"])->name("ioe.admission.letter");
    Route::get("/interfacultytransfer", [DashboardController::class, "interFacultyTransfer"])->name("transfers.interfaculty.index");
    Route::post("/interfacultytransfer", [DashboardController::class, "interFacultyTransferChange"])->name("transfers.interfaculty.updateform");
    Route::get("/iftf/fs/{form_setting_id}", [DashboardController::class, "formSettings"])->name("transfers.interfaculty.buy.form.fs");
    Route::get("/form/{id}", [DashboardController::class, "transferForm"])->name("transfers.interfaculty.form.buy.form");
    Route::get("/buy/transfer/form/{id}", [DashboardController::class, "pay"])->name("transfers.interfaculty.form.buy.form.post");
    Route::get("/buy/completed/form/{id}", [DashboardController::class, "completedForm"])->name("transfers.interfaculty.form.completed");

    Route::get("/documents", [StudentDocumentsController::class, "index"])->name("documents");
    Route::post("/upload-documents", [StudentDocumentsController::class, "upload"])->name("upload.documents");
    Route::get("/has-no-documents", [StudentDocumentsController::class, "hasNoDoc"])->name("has.no.documents");

    Route::get("/users", [UserController::class, "viewUser"])->name("user.view");
    Route::get("/users/{department}", [UserController::class, "show"])->name("user.show");
    Route::prefix("/errors")->group(function ($locale) {
        Route::get("/inactive", [ErrorController::class, "studentInactive"])->name("student.errors.inactive");
    });

    Route::prefix("/profile")->group(function () {
        Route::get("/view", [StudentBiodataController::class, "view"])->name("studentbiodata.view");
        Route::get("/edit", [StudentBiodataController::class, "edit"])->name("studentbiodata.edit");
        Route::post("/edit", [StudentBiodataController::class, "store"])->name("studentbiodata.store");
        Route::get("/", [StudentBiodataController::class, "index"])->name("studentbiodata.index");
        Route::get("/profile/image/{id}", [StudentBiodataController::class, "profilepicture"])->name("studentbiodata.photoupload");
        Route::get("/profile/image/{matric_number}", [StudentBiodataController::class, "profilepicturebymatric"])->name("studentbiodata.photoupload.matric");
        Route::get("/profile/signature/{id}", [StudentBiodataController::class, "profilesignature"])->name("studentbiodata.signatureupload");
        Route::get("/studentolevel", [StudentBiodataController::class, "getolevelresults"])->name("studentbiodata.studentolevel");
        Route::get("/password/change", [StudentBiodataController::class, "showpasswordchange"])->name("studentbiodata.changepassword");
        Route::post("/password/change", [StudentBiodataController::class, "changepassword"])->name("studentbiodata.password");
        Route::any("/addolevel", [StudentOlevelController::class, "store"])->name("studentbiodata.addolevel");
        Route::get("/idcard", [StudentBiodataController::class, "idcard"])->name("studentbiodata.idcard")->middleware("acceptance");
        Route::get("/printprofile", [StudentBiodataController::class, "printprofile"])->name("studentbiodata.printprofile");
        Route::post("/update/matric/{id}", [DashboardController::class, "updateMatric"])->name("student.update.matric.post");
    });

    //Accommodation
    Route::prefix("accommodation")->group(function () {
        Route::get("/student/index", [AccommodationController::class, "index"])->name("accommodation.index");
        Route::get("/student/noprofile", [AccommodationController::class, "noProfile"])->name("accommodation.noprofile");
        Route::get("/student/attestation", [AccommodationController::class, "attestation"])->name("accommodation.attestation");
        Route::get("/student/reservation", [AccommodationController::class, "reservation"])->name("accommodation.reservation");
        Route::get("/student/cancelreservation/{id}", [AccommodationController::class, "cancelReservation"])->name("accommodation.cancelreservation");
        Route::get("/student/expirereservations", [AccommodationController::class, "expireReservations"])->name("accommodation.expirereservations");
        Route::get("/student/block/chooseBlock", [BlockController::class, "getReservableBlockOptions"])->name("hostel.blockoptions");
        Route::get("/student/fetchrooms", [AccommodationController::class, "fetchrooms"])->name("accommodation.fetchrooms");
        Route::post("/student/reserve", [AccommodationController::class, "reserve"])->name("accommodation.reserve");
    });


//Transactions
    Route::prefix("transaction")->group(function () {
        Route::get("/accommodation/generate_rrr/{id}", [TransactionController::class, "generateAccRRR"])->name("transaction.accommodation.generaterrr");
        Route::get("/accommodation/verify_rrr", [TransactionController::class, "verifyAccRRR"])->name("transaction.accommodation.verifyrrr");
        Route::any("/accommodation/pay/{id?}", [TransactionController::class, "payAccommodation"])->name("transaction.accommodation.pay");
        Route::get("/accommodation/failpay/{id}", [TransactionController::class, "failAccPay"])->name("transaction.accommodation.failpay");
        Route::get("/accommodation/remitawebhook", [TransactionController::class, "remitaAccommodationWebHook"])->name("transaction.fees.remitawebhook");
        Route::get("/fees/generate_rrr/{id}", [TransactionController::class, "generateFeesRRR"])->name("transaction.fees.generaterrr");
        Route::get("/fees/verify_rrr", [TransactionController::class, "verifyFeesRRR"])->name("transaction.fees.verifyrrr");
        Route::any("/fees/pay/{id?}", [TransactionController::class, "payFees"])->name("transaction.fees.pay");
        Route::get("/fees/failpay/{id}", [TransactionController::class, "failFeesPay"])->name("transaction.fees.failpay");
        Route::get("/fees/remitawebhook", [TransactionController::class, "remitaFeesWebHook"])->name("transaction.fees.remitawebhook");
        Route::get("/fees/response", [TransactionController::class, "response"])->name("fees.response");
        Route::get("/test", [TransactionController::class, "test"])->name("fees.test");
    });

//Student biodata

//Fees
    Route::prefix("wallet")->group(function () {
        Route::get("/", [FeesController::class, "wallet"])->name("wallet.index");

    });
    Route::prefix("fees")->group(function () {
        Route::get("/pay/sundry/{session}", [FeesController::class, "paySundry"])->name("fees.pay.sundry");
        Route::get("/pay/viva/{session}", [FeesController::class, "payViva"])->name("fees.pay.viva");
        Route::post("/process", [FeesController::class, "process"])->name("fees.process");
        Route::get("/", [FeesController::class, "dashboard"])->name("fees.dashboard");
        Route::get("/index", [FeesController::class, "index"])->name("fees.index");
        Route::get("/others", [FeesController::class, "others"])->name("fees.others");
        Route::get("/others/viva", [FeesController::class, "viva"])->name("fees.others.viva");
        Route::get("/others/sundry", [FeesController::class, "sundry"])->name("fees.others.sundry");
        Route::get("/others/osc", [FeesController::class, "osc"])->name("fees.others.osc");
        Route::get("/others/osc/{osc_id}/pay", [FeesController::class, "payOsc"])->name("fees.others.osc.pay");
        Route::get("/others/osc/{osc_id}/list", [FeesController::class, "listOsc"])->name("fees.others.osc.list");
        Route::get("/others/osc/view/{id}", [FeesController::class, "oscDetails"])->name("fees.others.osc.view");
        Route::get("/session/{session}", [FeesController::class, "sessionView"])->name("fees.session");
        Route::get("/transaction/{session}", [FeesController::class, "transactionView"])->name("fees.transaction.view");
        Route::get("/payfee/{by}/{value}", [FeesController::class, "payFee"])->name("fees.payfee");
        Route::get("/payment/generate/rrr/{id}", [FeesController::class, "generateRRR"])->name("fees.payment.generate.rrr");
        Route::get("/payment/option/{session}/{id}", [FeesController::class, "paymentOptionChoose"])->name("fees.paymentoption.choose");
        Route::get("/payment/generate/{session}/{index}", [FeesController::class, "paymentOptionGenerateTransaction"])->name("fees.paymentoption.choosen");
        Route::get("/payment/transaction/{id}", [FeesController::class, "openTransaction"])->name("fees.transaction.open");
    });

///Student Alevel///////
    Route::prefix("alevel")->group(function () {
        Route::post("/delete/{id}", [StudentAlevelController::class, "destroy"])->name("studentalevel.destroy");
        Route::post("/edit/{id}", [StudentAlevelController::class, "store"])->name("studentalevel.store");
        Route::get("/edit/{id}", [StudentAlevelController::class, "create"])->name("studentalevel.edit");
        Route::get("/studentaddalevel", [StudentAlevelController::class, "create"])->name("alevel.create");
        Route::get("/view", [StudentAlevelController::class, "index"])->name("studentalevel.view");
        Route::get("/", [StudentAlevelController::class, "index"])->name("studentalevel");
    });

////MISC///////
    Route::prefix("misc")->group(function () {
        Route::post("/getsubjects", [StudentOlevelController::class, "getsubjects"])->name("misc.getsubjects");
        Route::post("/getgrades", [StudentOlevelController::class, "getgrades"])->name("misc.getgrades");
        Route::post("/getexamtypes", [StudentOlevelController::class, "getexamtypes"])->name("misc.getexamtypes");
        Route::post("/getolevelresults", [StudentOlevelController::class, "getolevelresults"])->name("misc.getolevelresults");
        Route::get("/states/{id}", [MiscController::class, "states"])->name("misc.states");
        Route::get("/lgas/{id}", [MiscController::class, "lgas"])->name("misc.lgas");
    });

////Student Photo Upload///////

    Route::post("/upload", [StudentPhotoUploadController::class, "uploadPicture"])->name("photoupload.applicant.uploadPicture");
    Route::get("/photoupload", [StudentPhotoUploadController::class, "index"])->name("photoupload.applicant.index");


//signature upload
    Route::post("/supload", [StudentSignatureUploadController::class, "uploadSignature"])->name("signatureupload.uploadsignature");
    Route::get("/signatureupload", [StudentSignatureUploadController::class, "index"])->name("signatureupload.index");

//Student Exams Card
    Route::prefix("examcard")->group(function () {
        Route::get("/", [ExamCardController::class, "index"])->name("examcard.index");
    });
// Student Result
    Route::prefix("gradebook")->group(function () {
        Route::get("/", [GradeBookController::class, "index"])->name("gradebook.index");
        Route::get("/{session}/{semester}", [GradeBookController::class, "results"])->name("gradebook.result");
    });

//  Evaluation
    Route::prefix("evaluation")->group(function () {
        Route::get("/course/{course_group_id}/{employee_id}", [EvaluationController::class, "evaluate"])->name("evaluation.evaluate");
        Route::post("/course/{course_group_id}/{employee_id}", [EvaluationController::class, "evaluatePost"])->name("evaluation.evaluate");
        Route::get("/", [EvaluationController::class, "index"])->name("evaluation.index");
    });

//  ABUMFB
    Route::prefix("abumfb")->group(function () {
        Route::any("/account/pay", [ABUMFBController::class, "makePay"])->name("student.abumfb.pay");
        Route::post("/account/create", [ABUMFBController::class, "store"])->name("student.abumfb.store");
        Route::post("/account/balance/{rubish}", [ABUMFBController::class, "balance"])->name("student.abumfb.balance");
        Route::get("/", [ABUMFBController::class, "create"])->name("student.abumfb.create");
        Route::any("/account/paysundry", [ABUMFBController::class, "makeSundryPayment"])->name("student.sundry.pay");
        Route::any("/account/payvivs", [ABUMFBController::class, "makeVivaPayment"])->name("student.viva.pay");
    });

//  Course Registration
    Route::prefix("courseregistration")->group(function () {

        Route::get("/print/{category}/{session}/{semester}", [CourseRegistrationController::class, "print"])->name("courseregistration.print");
        Route::get("/timetable/{session}/{semester}", [CourseRegistrationController::class, "timetable"])->name("courseregistration.timetable");
        Route::get("/activate", [CourseRegistrationController::class, "activate"])->name("courseregistration.activate");
        Route::post("/getschedules", [CourseRegistrationController::class, "getschedules"])->name("courseregistration.getschedules");

        Route::post("/getregcompcoursegroups/{session}", [CourseRegistrationController::class, "getRegCompCourseGroups"])->name("courseregistration.getregcompcoursegroups");
        Route::any("/getregelectcoursegroups/{session}", [CourseRegistrationController::class, "getRegElectCourseGroups"])->name("courseregistration.getregelectcoursegroups");
        Route::post("/getconfiguredcoursegroups/{session}/{semester}", [CourseRegistrationController::class, "getConfiguredCourseGroups"])->name("courseregistration.getconfiguredcoursegroups");
        Route::post("/getfaculties", [CourseRegistrationController::class, "getFaculties"])->name("courseregistration.getfaculties");
        Route::post("/getdepartments", [CourseRegistrationController::class, "getDepartments"])->name("courseregistration.getdepartments");
        Route::post("/getmorecourses/{session}", [CourseRegistrationController::class, "getMoreCourses"])->name("courseregistration.getmorecourses");
        Route::post("/getcourses", [CourseRegistrationController::class, "getCourses"])->name("courseregistration.getcourses");
        Route::get("/addcourse", [CourseRegistrationController::class, "addCourse"])->name("courseregistration.addcourse");
        Route::get("/deletecourse", [CourseRegistrationController::class, "deleteCourse"])->name("courseregistration.deletecourse");
        Route::post("/getcourseinfo/{session}", [CourseRegistrationController::class, "getCourseInfo"])->name("courseregistration.getcourseinfo");
        Route::post("/getfacility", [CourseRegistrationController::class, "getFacility"])->name("courseregistration.getfacility");
        Route::get("/jsshowmorecourses", [CourseRegistrationController::class, "jsShowMoreCourses"])->name("courseregistration.jsshowmorecourses");
        Route::post("/dashboard/{session}", [CourseRegistrationController::class, "index"])->name("courseregistration.index");
        Route::get("/dashboard/{session}", [CourseRegistrationController::class, "index"])->name("courseregistration.index");
    });

//  Exit/Clearance Form
    Route::get('exitform', [DashboardController::class, 'printExitForm'])->name('exitform.index');

    Route::prefix("resit")->group(function () {
        Route::get('/', [ResitController::class, 'index'])->name('resit.index');
        Route::post('/add', [ResitController::class, 'store'])->name('resit.save');
        Route::get('/view/{session}', [ResitController::class, 'view'])->name('resit.view');

    });
});



});
