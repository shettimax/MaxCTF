<?php

namespace App\Models;

use Illuminate\Database\Eloquent\Model;

class CandidateReferee extends Model {

    public static $refereerules = [
        "formid" => "required|exists:candidate_forms,id",
        "name" => "required|string|min:2",
        "email" => "required|email",
        "phone" => "required|min:6|max:25",
        "occupation" => "required|min:1|max:30",
    ];
    protected $guarded = [];

    public function candidateRefereeResponse() {
        return $this->hasOne('App\Models\CandidateRefereeResponse', 'refereeid');
    }
    public function candidateForm()
    {
         return $this->belongsTo(CandidateForm::class,'formid')->first();
    }
    public function formSettings()
    {
        return $this->candidateForm()->formSettings();
    }

    public function programme()
    {
        return $this->formSettings()->programme()->first();
    }

    public function candidate(){
        return $this->candidateForm()->candidate()->first();
    }

    public static function uniqueToken(){
        do{
            $token = str_random(28);
        }while(CandidateReferee::where('token','=',$token)->first());
        return $token;
    }


}
