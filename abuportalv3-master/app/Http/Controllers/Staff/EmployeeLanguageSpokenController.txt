<?php

namespace App\Http\Controllers\Staff;

use App\Models\EmployeeContactAddress;
use App\Models\EmployeeLanguageSpoken;
use App\Http\Controllers\Controller;
use Illuminate\Http\Request;
use App\Models\Employee;
use Illuminate\Support\Facades\Auth;
use Laravel\Tinker\ClassAliasAutoloader;


class EmployeeLanguageSpokenController extends Controller
{

    public function __construct()
    {
        $this->middleware(["auth:staff"]);
    }

    public function index(){
//        return Auth::user();
        $employee = Employee::find(Auth::user()->employee_id);
        return view('pages.staff.profile.languagespoken', compact('employee'));
    }

    public function storeLanguageSpoken(Request $request){
        try{
            $this->validate($request,[
                'language'=>'required'
            ]);
            $language = EmployeeLanguageSpoken::find($request->language_id);
            if(!$language)
                $language = new EmployeeLanguageSpoken();
            $language->name = $request->language;
            $language->employee_id = $request->employee_id;
            $language->save();
            return redirect()->back()->with('success', 'Done!');
        }catch(\Exception $e){
//            return redirect()->back()->with('error', $e->getMessage().' Fields cannot be empty');
            return $e->getMessage();
        }
    }

    public function deleteLanguageSpoken(EmployeeLanguageSpoken $employeeLanguageSpoken){
        try{
            EmployeeLanguageSpoken::destroy($employeeLanguageSpoken->id);
            return redirect()->back()->with('success', 'Done!');
        }catch (\Exception $e){
            return redirect()->back()->with('error', $e->getMessage());
        }

    }
}

